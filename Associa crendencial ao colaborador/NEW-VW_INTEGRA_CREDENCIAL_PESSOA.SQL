

SELECT 'P.CD_PESSOA' AS "PersonId",
       C.NU_CREDENCIAL AS "CredentialNumber",
       TO_CHAR(TRUNC(SYSDATE), 'YYYY-MM-DD') AS "InitialDate"
  FROM DEFAULT_ACESSO.PESSOA@MADIS P
 INNER JOIN SENIOR.TB_COLABORADOR SC
    ON P.NU_CPF = SC.CPF
   AND SC.SITUACAO_AFASTAMENTO <> 7
 INNER JOIN DEFAULT_ACESSO.CREDENCIAL@MADIS C
    ON C.NU_CREDENCIAL = P.NU_PIS
   AND P.NU_PIS IS NOT NULL
   AND NOT EXISTS (SELECT 1
          FROM DEFAULT_ACESSO.CREDENCIAL_PESSOA@MADIS CP
         WHERE CP.CD_CREDENCIAL = C.CD_CREDENCIAL
           AND CP.CD_PESSOA = P.CD_PESSOA);
